<script type="text/javascript">

	var ident;
	var posicion;
	var status;

	$( window ).load( function(){

	        toastr.clear();
	        var text = "";

		$.ajax({

			method:"POST",
			url: "{{ path('listadoConcursosAjax') }}",
			dataType: 'json',
	        success: function(data)
	        {
	            if (data == "N"){

	                text = "No Hay Concursos Registrados";

	                toastr.error(text, "Error", {
	                    "timeOut": "0",
	                    "extendedTImeout": "0"
	                 });

	            } else{                   

	                for (var i = 0; i <= data["id"].length-1; i++) {

	                    var num = data["id"][i];

	                    tabla.row.add( {
	                        "inicio": data["fechaInicio"][i],
	                        "vacantes": data["nroVacantes"][i],
	                        "condicion": data["condicion"][i],
	                        "facultad": data["facultad"][i],
	                        "status": data["status"][i],
	                       // "ver": '<span class="glyphicon glyphicon-search" onclick="javascript:ver('+num+')"></span>',
	                        "modif": '<span class="glyphicon glyphicon-pencil" onclick="javascript:modificar('+num+','+i+')" data-toggle="modal" data-target="#myModal2"></span>',
	                        "elim": '<span class="glyphicon glyphicon-trash" onclick="javascript:eliminar('+num+','+i+')" data-toggle="modal" data-target="#myModal"></span>'
	                    }).draw();                         
	                }                                             
	            }                       	
	        }
	    });
	});
	

	$("#eliminarConcurso").click(function(){

		tabla1.clear().draw();
		tabla2.clear().draw();
		tabla3.clear().draw();
		tabla4.clear().draw();
		toastr.clear();

	    $.ajax({

	        method:"POST",
	        url: "{{ path('borrarConcursoAjax') }}",
	        dataType: 'json',
	        data: {"id": ident},
	        success: function(data)
	        {
	            if (data == "N"){

	                text = "Usted No Tiene Permiso";

	                toastr.error(text, "Error", {
	                    "timeOut": "0",
	                    "extendedTImeout": "0"
	                 });

	            } else {

	                text = "Concurso Eliminado";

	                toastr.success(text, "Exito", {
	                    "timeOut": "0",
	                    "extendedTImeout": "0"
	                 });

	                $('#myModal').modal('toggle');

	                tabla.clear().draw();
	
						$.ajax({

							method:"POST",
							url: "{{ path('listadoConcursosAjax') }}",
							dataType: 'json',
					        success: function(data)
					        {
				                for (var i = 0; i <= data["id"].length-1; i++) {

				                    var num = data["id"][i];

				                    tabla.row.add( {
				                        "inicio": data["fechaInicio"][i],
				                        "vacantes": data["nroVacantes"][i],
				                        "condicion": data["condicion"][i],
				                        "facultad": data["facultad"][i],
				                        "status": data["status"][i],
				                       // "ver": '<span class="glyphicon glyphicon-search" onclick="javascript:ver('+num+')"></span>',
				                        "modif": '<span class="glyphicon glyphicon-pencil" onclick="javascript:modificar('+num+','+i+')" data-toggle="modal" data-target="#myModal2"></span>',
				                        "elim": '<span class="glyphicon glyphicon-trash" onclick="javascript:eliminar('+num+','+i+')" data-toggle="modal" data-target="#myModal"></span>'
				                    }).draw();                         
				                }                        	
					        }
					     });

	               ident = null; 
	               posicion = null;
	            }                                                               
	        }
	    });
	});


	$("#actualizarConcurso").click(function(){

		toastr.clear();
        var text = "";

        var continua = true;

        if (status == "Esperando Por Presupuesto") {

	        $('#div_presupuesto').removeClass("has-error");

	        if ($('#disponibilidad').val() == "..."){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_presupuesto').addClass("has-error");
	        }

	        $('#div_fecha').removeClass("has-error");

	        if ($('#fecha').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_fecha').addClass("has-error");
	        }

	        $('#div_control').removeClass("has-error");

	        if ($('#control').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_control').addClass("has-error");
	        }
        }

        if (status == "Esperando Por Concejo De Escuela") {

        	$('#div_control1').removeClass("has-error");

	        if ($('#control1').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_control1').addClass("has-error");
	        }
        }

        if (status == "Esperando Por Concejo De Asuntos Profesorales") {

        	$('#div_avala').removeClass("has-error");

	        if ($('#avala').val() == "..."){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_avala').addClass("has-error");
	        }

	        $('#div_justificacion').removeClass("has-error");

	        if ($('#justificacion').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_justificacion').addClass("has-error");
	        }

	        $('#div_cargo').removeClass("has-error");

	        if ($('#cargo').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_cargo').addClass("has-error");
	        }

	        $('#div_nya').removeClass("has-error");

	        if ($('#nya').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_nya').addClass("has-error");
	        }

	        $('#div_cedula').removeClass("has-error");

	        if ($('#cedula').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_cedula').addClass("has-error");
	        }

	        $('#div_fecha1').removeClass("has-error");

	        if ($('#fecha1').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_fecha1').addClass("has-error");
	        }

	        $('#div_control2').removeClass("has-error");

	        if ($('#control2').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_control2').addClass("has-error");
	        }
        }

        if (status == "Esperando Por Auditoría Académica") {

        	$('#div_avala1').removeClass("has-error");

	        if ($('#avala1').val() == "..."){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_avala1').addClass("has-error");
	        }

	        $('#div_justificacion1').removeClass("has-error");

	        if ($('#justificacion1').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_justificacion1').addClass("has-error");
	        }

	        $('#div_cargo1').removeClass("has-error");

	        if ($('#cargo1').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_cargo1').addClass("has-error");
	        }

	        $('#div_nya1').removeClass("has-error");

	        if ($('#nya1').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_nya1').addClass("has-error");
	        }

	        $('#div_cedula1').removeClass("has-error");

	        if ($('#cedula1').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_cedula1').addClass("has-error");
	        }

	        $('#div_fecha2').removeClass("has-error");

	        if ($('#fecha2').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_fecha2').addClass("has-error");
	        }

	        $('#div_control3').removeClass("has-error");

	        if ($('#control3').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_control3').addClass("has-error");
	        }
        }


        if (status == "Esperando Por Consejo De Facultad") {

        	$('#div_avala2').removeClass("has-error");

	        if ($('#avala2').val() == "..."){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_avala2').addClass("has-error");
	        }

	        $('#div_justificacion2').removeClass("has-error");

	        if ($('#justificacion2').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_justificacion2').addClass("has-error");
	        }

	        $('#div_cargo2').removeClass("has-error");

	        if ($('#cargo2').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_cargo2').addClass("has-error");
	        }

	        $('#div_nya2').removeClass("has-error");

	        if ($('#nya2').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_nya2').addClass("has-error");
	        }

	        $('#div_cedula2').removeClass("has-error");

	        if ($('#cedula2').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_cedula2').addClass("has-error");
	        }

	        $('#div_control4').removeClass("has-error");

	        if ($('#control4').val() == ""){

	            continua = false;
	            text = "Campo vacío";
	            $('#div_control4').addClass("has-error");
	        }
        }

        if (continua) {

        	// enviar actualizacion

        } else {
             toastr.error(text, "Error", {
                "timeOut": "0",
                "extendedTImeout": "0"
             });
        }
	});
	
	function eliminar(id, pos){

	    ident = id;
	    posicion = pos;

	    $.ajax({

	        method:"POST",
	        url: "{{ path('buscarConcursoAjax') }}",
	        dataType: 'json',
	        data: {"id": id},
	        success: function(data)
	        {
	            if (data == "N"){

	                text = "No Se Encontró El Concurso";

	                toastr.error(text, "Error", {
	                    "timeOut": "0",
	                    "extendedTImeout": "0"
	                 });

	            } else{                 
	                
	                document.getElementById("nroVacantes1").value = data["nroVacantes"][0];
	                document.getElementById("facultad1").value = data["facultad"][0]; 
	                document.getElementById("status1").value = data["status"][0]; 
	                document.getElementById("condicion1").value = data["condicion"][0];         
	            }                           
	        }
	    });
	}

	function modificar(id, pos){

	    ident = id;
	    posicion = pos;

	    $.ajax({

	        method:"POST",
	        url: "{{ path('buscarConcursoAjax') }}",
	        dataType: 'json',
	        data: {"id": id},
	        success: function(data)
	        {
	            if (data == "N"){

	                text = "No Se Encontró El Concurso";

	                toastr.error(text, "Error", {
	                    "timeOut": "0",
	                    "extendedTImeout": "0"
	                 });

	            } else{       

	            	status = data["status"][0];         
	                
	                document.getElementById("nroVacantes2").value = data["nroVacantes"][0];
	                document.getElementById("facultad2").value = data["facultad"][0]; 
	                document.getElementById("status2").value = data["status"][0]; 
	                document.getElementById("condicion2").value = data["condicion"][0];

	                $("#presupuesto").addClass("hide");
	                $("#cf").addClass("hide");
	                $("#prof").addClass("hide");
	                $("#auditoria").addClass("hide");
	                $("#consejo").addClass("hide");

	                if (status == "Esperando Por Presupuesto")
	                	$("#presupuesto").removeClass("hide");
	                else {

	                	if (status == "Esperando Por Concejo De Escuela") 
	                		$("#cf").removeClass("hide");
	                	else {

	                		if (status == "Esperando Por Concejo De Asuntos Profesorales") 
	                			$("#prof").removeClass("hide");
	                		else {

	                			if (status == "Esperando Por Auditoría Académica") 
	                				$("#auditoria").removeClass("hide");
	                			else $("#consejo").removeClass("hide");
	                		}
	                	}
	                }        
	            }                           
	        }
	    });
	}

</script>